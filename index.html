<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<script>
function trollText(){
	var original = document.getElementById("english").value;
	var result = "";
	if (trollName.value == "kanaya") {
		result = kanayaText(original);
	} else if (trollName.value == "novasa") {
		result = novasaText(original);	
	} else if (trollName.value == "komori") {
		result = komoriText(original);
	} else if (trollName.value == "machni") {
		result = machniText(original);
	} else if (trollName.value == "korsak") {
		result = korsakText(original);
	} else if (trollName.value == "zeulin") {
		result = zeulinText(original);
	} else if (trollName.value == "vathsa") {
		result = vathsaText(original);
	} else if (trollName.value == "nephra") {
		result = nephraText(original);
	} else if (trollName.value == "seliah") {
		result = seliahText(original);
	} else if (trollName.value == "hundra") {
		result = hundraText(original);
	} else if (trollName.value == "terran") {
		result = terranText(original);
	}
	document.getElementById("troll").value = result;
}

function kanayaText(original){
	var initialCaps = original.replace(/\w\S*/g, function(txt){
			return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
			});
	return initialCaps;
}

function novasaText(original){
	var replaced = "";
	for (var i = 0; i < original.length; i++){
		letterToAdd = original.charAt(i);
		if (letterToAdd == 'k') {
			letterToAdd = 'K';
		} else if (letterToAdd == 'c' || letterToAdd == 'C') {
			if (i + 1 < original.length && 'ieyIEY'.indexOf(original.charAt(i+1)) != -1) {
				letterToAdd = 's';
			} else if (i + 1 < original.length && 'hH'.indexOf(original.charAt(i+1)) != -1) {
				letterToAdd = 'k';
			} else {
				letterToAdd = 'K';
			}
		
		}
		replaced += letterToAdd;
	}
	return replaced;
}

function komoriText(original){
	var replaced = original.replace(/[sS]/g, "5");
	return replaced;
}

function machniText(original){
	var replaced = original.replace(/\./g, "(・ω・)");
	return replaced;
}

function korsakText(original){
	var replaced = original.replace(/p/g, "|>");
	return replaced;
}

function zeulinText(original){
	var replaced = original.replace(/[^A-Za-z0-9]/g, function(x) { return x+x; });
	return replaced;
}

function vathsaText(original){
	var replaced = original.replace(/[oO]/g, "0");
	replaced = replaced.replace(/[A-Z]/g, function(x) { return x.toLowerCase(); });
	return replaced;
}

function nephraText(original) {
	var replaced = "";
	var capThisWord = false;
		for (var i = 0; i < original.length; i++){
			letterToAdd = original.charAt(i);
			if (i > 0){
				prevLetter = original.charAt(i-1);
				if (".?! ".indexOf(prevLetter) != -1 && i+1 < original.length && 
				".?! ".indexOf(letterToAdd) == -1){
					if (capThisWord) {
						letterToAdd = letterToAdd.toUpperCase();
					} else {
						letterToAdd = letterToAdd.toLowerCase();
					}
					capThisWord = !capThisWord;
				}
			}
			replaced += letterToAdd;
		}
	return replaced;
}

function seliahText(original){
	var replaced = original.replace(/so/g, "sew");
	return replaced;
}

function hundraText(original){
	var replaced = original.replace(/[sS]/g, "7");
	replaced = replaced.replace(/[gG]/g, "9");
	replaced = replaced.replace(/[lL]/g, "1");
	return replaced;
}

function terranText(original){
	var sentences = original.match(/([^\.!\?]+[\.!\?]+)|([^\.!\?]+$)/g);
	var replacedText = "";
	for (var i = 0; i < sentences.length; i++) {
		replacedText += "}" + sentences[i].trim() + "{ ";
	}
	return replacedText;
}
</script>

<select id="trollName" style="border: 2px solid black">
  <option value="kanaya">Kanaya</option>
  <option value="novasa">apocalypseKiller</option>
  <option value="komori">carbineSeafoam</option>
  <option value="machni">indigoUranus</option>
  <option value="korsak">mechaFurry</option>
  <option value="zeulin">whiteJester</option>
  <option value="vathsa">temporalPhobic</option>
  <option value="nephra">hollowCommander</option>
  <option value="seliah">angelToe</option>
  <option value="hundra">vitalAlchemist</option>
  <option value="terran">heraldicDoctor</option>
</select> 
<p>Enter Text:</p>

<textarea id="english" rows=10 cols=40 style="border: 2px solid black">
</textarea>

<textarea id="troll" rows=10 cols=40 style="border: 2px solid black">
</textarea>
<p></p>
<button id="convert" onclick="trollText()">Convert!</button>
